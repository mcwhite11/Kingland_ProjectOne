@{
    //Grab our username and other form data
    var thisUser = Request.Form["thisUser"];
    var first = Request.Form["first"];
    var last = Request.Form["last"];
    var email = Request.Form["email"];
    var prefName = Request.Form["prefName"];
    var position = Request.Form["position"].Trim();
    var dept = Request.Form["dept"].Trim();
    var supervisor = Request.Form["supervisor"].Trim();
    var hmEmail = "TEST@TEST.COM";//CREATE FUNCTION TO GRAB EMAIL WITH AD
    var actSD = Request.Form["actSD"];

    //Open and connect to DB
    var db = Database.Open("kinglandDatabase");
    
    //Grab old supervisor.. Did it change?
    var checkSup = db.QuerySingle("SELECT hmName FROM users WHERE user = @0", thisUser);

    //If it did, send our emails to inform old/new supervisor
    if ( @checkSup.hmName.Equals(supervisor) == false ) {
        //Send emails to respective people
            //Send to old supervisor
            //Send to new supervisor
    }

    //Update users table
    db.QuerySingle("UPDATE users SET first = @0, last = @1, email = @2, hmemail = @3, prefName = @4, position = @5, dept = @6, startDate = @7, hmName = @8 WHERE user = @9", first, last, email, hmEmail, prefName, position, dept, actSD, supervisor, thisUser);
    
    //Head to Check status
	Response.Redirect("checkStatus.cshtml?user="+thisUser); 
} 

